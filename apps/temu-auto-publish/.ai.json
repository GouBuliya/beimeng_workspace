{
  "name": "temu-auto-publish",
  "type": "app",
  "version": "2.0.0",
  "description": "Temu 商品自动发布系统 - SOTA 工业级",
  "purpose": "自动化妙手 ERP 商品发布全流程，从采集到批量编辑到发布",
  "entry_point": "cli/main.py",
  "interface": {
    "cli": {
      "command": "temu-auto-publish",
      "subcommands": [
        {
          "name": "workflow",
          "description": "工作流执行和管理",
          "commands": ["run", "resume", "list", "status"]
        },
        {
          "name": "monitor",
          "description": "监控和指标分析",
          "commands": ["stats", "report", "watch"]
        },
        {
          "name": "debug",
          "description": "调试功能管理",
          "commands": ["enable", "disable", "list", "clean"]
        },
        {
          "name": "config",
          "description": "配置管理",
          "commands": ["show", "validate", "init"]
        }
      ]
    },
    "api": {
      "core_classes": [
        "WorkflowExecutor",
        "RetryHandler",
        "MetricsCollector"
      ],
      "workflows": [
        "CompletePublishWorkflow",
        "FiveToTwentyWorkflow"
      ],
      "controllers": [
        "LoginController",
        "MiaoshouController",
        "FirstEditController",
        "BatchEditController",
        "PublishController"
      ]
    }
  },
  "architecture": {
    "layers": [
      "cli - 命令行入口层",
      "core - 核心业务逻辑（执行器、重试、指标）",
      "workflows - 工作流编排",
      "browser - 浏览器控制器",
      "utils - 工具函数",
      "models - 数据模型",
      "config - 配置管理"
    ],
    "patterns": [
      "Command Pattern - CLI 命令",
      "Strategy Pattern - 重试策略",
      "Observer Pattern - 指标收集",
      "State Pattern - 工作流状态"
    ],
    "tech_stack": {
      "language": "Python 3.12+",
      "frameworks": ["Playwright", "Typer", "Pydantic"],
      "libraries": ["loguru", "rich", "pyyaml"]
    }
  },
  "configuration": {
    "environments": ["development", "staging", "production"],
    "config_files": [
      "config/environments/dev.yaml",
      "config/environments/staging.yaml",
      "config/environments/prod.yaml"
    ],
    "env_file": ".env",
    "settings_class": "config.settings.Settings"
  },
  "dependencies": {
    "python": ">=3.12",
    "packages": [
      "playwright>=1.40.0",
      "typer[all]>=0.9.0",
      "pydantic>=2.5.0",
      "pydantic-settings>=2.1.0",
      "loguru>=0.7.0",
      "rich>=13.7.0",
      "pyyaml>=6.0.1",
      "python-dotenv>=1.0.0"
    ]
  },
  "examples": [
    {
      "description": "执行完整工作流",
      "command": "temu-auto-publish workflow run --products products.json",
      "use_case": "从产品数据文件执行5→20→批量编辑流程"
    },
    {
      "description": "查看性能指标",
      "command": "temu-auto-publish monitor stats --last 24h",
      "use_case": "查看最近24小时的执行统计"
    },
    {
      "description": "生成报告",
      "command": "temu-auto-publish monitor report -o report.csv",
      "use_case": "导出指标数据为CSV报告"
    },
    {
      "description": "查看系统状态",
      "command": "temu-auto-publish status",
      "use_case": "检查配置和环境状态"
    },
    {
      "description": "初始化设置",
      "command": "temu-auto-publish setup",
      "use_case": "首次使用时的初始化向导"
    }
  ],
  "features": {
    "core": [
      "多环境配置支持（dev/staging/prod）",
      "智能重试机制（指数退避）",
      "结构化日志（JSON/详细格式）",
      "全面指标收集（工作流/阶段/操作级别）",
      "断点续传（状态保存和恢复）"
    ],
    "workflow": [
      "5→20 产品扩展流程",
      "18步批量编辑",
      "智能价格计算",
      "自动发布到店铺"
    ],
    "observability": [
      "实时日志输出",
      "性能指标统计",
      "错误追踪和分类",
      "执行历史查询"
    ]
  },
  "tags": [
    "automation",
    "e-commerce",
    "temu",
    "miaoshou",
    "workflow",
    "cli",
    "industrial-grade",
    "sota"
  ],
  "ai_hints": {
    "common_use_cases": [
      "执行完整工作流: temu-auto-publish workflow run",
      "恢复中断的工作流: temu-auto-publish workflow resume state.json",
      "查看执行历史: temu-auto-publish workflow list",
      "监控性能指标: temu-auto-publish monitor stats",
      "调试问题: temu-auto-publish debug list",
      "验证配置: temu-auto-publish config validate config.yaml"
    ],
    "gotchas": [
      "首次使用必须运行 setup 命令进行初始化",
      "登录凭证必须存储在 .env 文件中",
      "生产环境必须设置 ENVIRONMENT=production",
      "调试模式会显著降低性能，生产环境应禁用",
      "Playwright 需要先安装浏览器: playwright install chromium",
      "状态文件较大，定期清理 data/workflow_states/",
      "指标数据会占用磁盘空间，定期导出和清理"
    ],
    "troubleshooting": {
      "login_failed": "检查 .env 中的用户名密码是否正确",
      "timeout": "增加 browser.timeout 配置或启用重试",
      "out_of_memory": "减少并发操作或降低截图频率",
      "selector_not_found": "页面结构可能变化，更新 selectors 配置"
    },
    "best_practices": [
      "开发时使用 dev 环境配置",
      "生产环境启用 headless 模式",
      "定期导出指标数据进行分析",
      "使用 workflow resume 恢复失败的流程",
      "配置合适的重试次数避免过度重试",
      "定期备份工作流状态文件"
    ],
    "related_components": [
      "packages/common/logger",
      "packages/common/config",
      "packages/mcp_file_info"
    ]
  }
}
