# Temuè‡ªåŠ¨å‘å¸ƒç³»ç»Ÿ - ç”Ÿäº§ç¯å¢ƒä½¿ç”¨æŒ‡å—

> å®Œæ•´å®ç°SOPæ­¥éª¤4-11çš„å¸¸æ€åŒ–è‡ªåŠ¨å‘å¸ƒè„šæœ¬

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
3. [å®‰è£…éƒ¨ç½²](#å®‰è£…éƒ¨ç½²)
4. [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
5. [ä½¿ç”¨æ–¹å¼](#ä½¿ç”¨æ–¹å¼)
6. [å®šæ—¶ä»»åŠ¡](#å®šæ—¶ä»»åŠ¡)
7. [ç›‘æ§å‘Šè­¦](#ç›‘æ§å‘Šè­¦)
8. [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
9. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## ç³»ç»Ÿæ¦‚è¿°

### åŠŸèƒ½ç‰¹æ€§

æœ¬ç³»ç»Ÿå®ç°äº†SOPæ­¥éª¤4-11çš„å®Œæ•´è‡ªåŠ¨åŒ–ï¼š

**å®ç°çš„SOPæ­¥éª¤ï¼š**
- âœ… æ­¥éª¤4-6: 5â†’20å·¥ä½œæµï¼ˆé¦–æ¬¡ç¼–è¾‘+è®¤é¢†ï¼‰
- âœ… æ­¥éª¤7: æ‰¹é‡ç¼–è¾‘18æ­¥
- âœ… æ­¥éª¤8-9: é€‰æ‹©åº—é“º+è®¾ç½®ä¾›è´§ä»·
- âœ… æ­¥éª¤10-11: æ‰¹é‡å‘å¸ƒ+æŸ¥çœ‹ç»“æœ

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- ğŸ¯ åŒè¾“å…¥æ¨¡å¼ï¼šæ”¯æŒExcelé€‰å“è¡¨å’ŒJSONé…ç½®
- ğŸ”„ å®šæ—¶ä»»åŠ¡ï¼šåŸºäºCronè¡¨è¾¾å¼çš„è‡ªåŠ¨åŒ–è°ƒåº¦
- ğŸ”” å¤šæ¸ é“é€šçŸ¥ï¼šé’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ã€é‚®ä»¶
- ğŸ¥ å¥åº·æ£€æŸ¥ï¼šæ‰§è¡Œå‰è‡ªåŠ¨æ£€æµ‹ç³»ç»ŸçŠ¶æ€
- ğŸ’¾ æ–­ç‚¹ç»­ä¼ ï¼šæ”¯æŒå¤±è´¥æ¢å¤å’ŒçŠ¶æ€ä¿å­˜
- ğŸ“Š æŒ‡æ ‡æ”¶é›†ï¼šå®Œæ•´çš„æ‰§è¡Œæ•°æ®å’Œç»Ÿè®¡åˆ†æ
- ğŸ›¡ï¸ å®¹é”™æœºåˆ¶ï¼šè‡ªåŠ¨é‡è¯•å’Œé™çº§å¤„ç†

### ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·å±‚                              â”‚
â”‚  CLIå‘½ä»¤ / å®šæ—¶ä»»åŠ¡ / æ‰‹åŠ¨æ‰§è¡Œ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æ ¸å¿ƒå±‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ç”Ÿäº§è„šæœ¬   â”‚ â”‚å®ˆæŠ¤è¿›ç¨‹   â”‚ â”‚å¥åº·æ£€æŸ¥   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                å·¥ä½œæµå±‚                               â”‚
â”‚  5â†’20å·¥ä½œæµ â†’ æ‰¹é‡ç¼–è¾‘ â†’ å‘å¸ƒæµç¨‹                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ§åˆ¶å™¨å±‚                                 â”‚
â”‚  ç™»å½• / é‡‡é›†ç®± / ç¼–è¾‘ / å‘å¸ƒ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æµè§ˆå™¨è‡ªåŠ¨åŒ–å±‚                             â”‚
â”‚  Playwright + Chromium                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Python 3.12+
- è‡³å°‘10GBå¯ç”¨ç£ç›˜ç©ºé—´
- 2GB+ å¯ç”¨å†…å­˜
- ç¨³å®šçš„ç½‘ç»œè¿æ¥

### 5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd apps/temu-auto-publish

# 2. å®‰è£…ä¾èµ–
uv sync

# 3. å®‰è£…Playwrightæµè§ˆå™¨
playwright install chromium

# 4. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¤åˆ¶.env.exampleå¹¶ç¼–è¾‘ï¼‰
cp .env.example .env
# ç¼–è¾‘.envï¼Œå¡«å†™MIAOSHOU_USERNAMEå’ŒMIAOSHOU_PASSWORD

# 5. éªŒè¯ç¯å¢ƒ
python scripts/validate_production.py validate

# 6. è¿è¡Œæµ‹è¯•(Dry-runæ¨¡å¼)
python scripts/run_production.py data/input/example.xlsx --dry-run

# 7. æ­£å¼è¿è¡Œ
python scripts/run_production.py data/input/selection.xlsx
```

---

## å®‰è£…éƒ¨ç½²

### è¯¦ç»†å®‰è£…æ­¥éª¤

#### 1. å®‰è£…Pythonä¾èµ–

```bash
# ä½¿ç”¨uvï¼ˆæ¨èï¼‰
uv sync

# æˆ–ä½¿ç”¨pip
pip install -r requirements.txt
```

#### 2. å®‰è£…Playwrightæµè§ˆå™¨

```bash
playwright install chromium
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º`.env`æ–‡ä»¶ï¼š

```bash
# ç™»å½•å‡­è¯ï¼ˆå¿…é¡»ï¼‰
MIAOSHOU_USERNAME=your_username
MIAOSHOU_PASSWORD=your_password

# AIé…ç½®ï¼ˆå¯é€‰ï¼Œç”¨äºæ ‡é¢˜ç”Ÿæˆï¼‰
OPENAI_API_KEY=sk-...

# é‚®ä»¶é€šçŸ¥é…ç½®ï¼ˆå¯é€‰ï¼‰
SMTP_USERNAME=your_email@example.com
SMTP_PASSWORD=your_password
```

#### 4. é…ç½®ç”Ÿäº§ç¯å¢ƒ

ç¼–è¾‘`config/production.yaml`ï¼š

```yaml
# å…³é”®é…ç½®é¡¹
notification:
  dingtalk:
    enabled: true
    webhook_url: "https://oapi.dingtalk.com/robot/send?access_token=YOUR_TOKEN"

scheduler:
  jobs:
    - name: "daily_publish"
      enabled: true
      schedule: "0 9 * * *"  # æ¯å¤©9ç‚¹
      input_type: "excel"
      input_path: "data/input/selection.xlsx"
```

#### 5. éªŒè¯å®‰è£…

```bash
python scripts/validate_production.py validate
```

å¦‚æœæ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼Œè¯´æ˜å®‰è£…æˆåŠŸï¼

### ç›®å½•ç»“æ„

```
apps/temu-auto-publish/
â”œâ”€â”€ config/                    # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ production.yaml        # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ notification.yaml.template  # é€šçŸ¥é…ç½®æ¨¡æ¿
â”œâ”€â”€ data/                      # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ input/                 # è¾“å…¥æ–‡ä»¶ï¼ˆExcel/JSONï¼‰
â”‚   â”œâ”€â”€ output/                # æ‰§è¡Œç»“æœ
â”‚   â”œâ”€â”€ logs/                  # æ—¥å¿—æ–‡ä»¶
â”‚   â”œâ”€â”€ metrics/               # æŒ‡æ ‡æ•°æ®
â”‚   â””â”€â”€ workflow_states/       # å·¥ä½œæµçŠ¶æ€
â”œâ”€â”€ scripts/                   # è„šæœ¬
â”‚   â”œâ”€â”€ run_production.py      # ç”Ÿäº§ç¯å¢ƒä¸»è„šæœ¬
â”‚   â”œâ”€â”€ scheduler_daemon.py    # å®šæ—¶ä»»åŠ¡å®ˆæŠ¤è¿›ç¨‹
â”‚   â””â”€â”€ validate_production.py # ç¯å¢ƒéªŒè¯è„šæœ¬
â”œâ”€â”€ src/                       # æºä»£ç 
â”‚   â”œâ”€â”€ core/                  # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ notification_service.py  # é€šçŸ¥æœåŠ¡
â”‚   â”‚   â””â”€â”€ health_checker.py        # å¥åº·æ£€æŸ¥
â”‚   â”œâ”€â”€ workflows/             # å·¥ä½œæµ
â”‚   â””â”€â”€ browser/               # æµè§ˆå™¨æ§åˆ¶å™¨
â””â”€â”€ cli/                       # CLIå‘½ä»¤
```

---

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®ï¼ˆ.envï¼‰

| å˜é‡å | å¿…é¡» | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| `MIAOSHOU_USERNAME` | âœ… | å¦™æ‰‹ERPç”¨æˆ·å | `zhangsan` |
| `MIAOSHOU_PASSWORD` | âœ… | å¦™æ‰‹ERPå¯†ç  | `password123` |
| `OPENAI_API_KEY` | âŒ | OpenAI APIå¯†é’¥ | `sk-...` |
| `SMTP_USERNAME` | âŒ | SMTPç”¨æˆ·å | `user@example.com` |
| `SMTP_PASSWORD` | âŒ | SMTPå¯†ç  | `password` |

### ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆproduction.yamlï¼‰

#### é€šçŸ¥é…ç½®

```yaml
notification:
  # é’‰é’‰æœºå™¨äºº
  dingtalk:
    enabled: true
    webhook_url: "https://oapi.dingtalk.com/robot/send?access_token=YOUR_TOKEN"
  
  # ä¼ä¸šå¾®ä¿¡æœºå™¨äºº
  wecom:
    enabled: false
    webhook_url: "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=YOUR_KEY"
  
  # é‚®ä»¶é€šçŸ¥
  email:
    enabled: false
    smtp_host: "smtp.example.com"
    smtp_port: 587
    username: "your_email@example.com"
    password: ""
    from_addr: "noreply@example.com"
    to_addrs:
      - "admin@example.com"
```

#### å®šæ—¶ä»»åŠ¡é…ç½®

```yaml
scheduler:
  jobs:
    - name: "morning_publish"      # ä»»åŠ¡åç§°
      enabled: true                 # æ˜¯å¦å¯ç”¨
      schedule: "0 9 * * *"        # Cronè¡¨è¾¾å¼(æ¯å¤©9ç‚¹)
      input_type: "excel"          # è¾“å…¥ç±»å‹(excel/json)
      input_path: "data/input/selection.xlsx"  # è¾“å…¥æ–‡ä»¶è·¯å¾„
      staff_name: "å¼ ä¸‰"            # äººå‘˜ç­›é€‰(å¯é€‰)
      enable_batch_edit: true      # æ˜¯å¦æ‰¹é‡ç¼–è¾‘
      enable_publish: true         # æ˜¯å¦å‘å¸ƒ
      use_ai_titles: true          # æ˜¯å¦ä½¿ç”¨AIæ ‡é¢˜
```

#### Cronè¡¨è¾¾å¼è¯´æ˜

```
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿ (0 - 59)
 â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ (0 - 23)
 â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ—¥ (1 - 31)
 â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœˆ (1 - 12)
 â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ˜ŸæœŸ (0 - 6) (0=å‘¨æ—¥)
 â”‚ â”‚ â”‚ â”‚ â”‚
 * * * * *

ç¤ºä¾‹ï¼š
0 9 * * *       # æ¯å¤©9ç‚¹
0 9,14 * * *    # æ¯å¤©9ç‚¹å’Œ14ç‚¹
0 9 * * 1-5     # å·¥ä½œæ—¥9ç‚¹
0 */2 * * *     # æ¯2å°æ—¶
30 8-18 * * 1-5 # å·¥ä½œæ—¥8:30-18:30æ¯å°æ—¶
```

### è¾“å…¥æ•°æ®æ ¼å¼

#### Excelæ ¼å¼ï¼ˆæ¨èï¼‰

ä½¿ç”¨ç°æœ‰çš„é€‰å“è¡¨æ ¼å¼ï¼ŒåŒ…å«ä»¥ä¸‹åˆ—ï¼š

- ä¸»å“è´Ÿè´£äºº
- äº§å“åç§°
- æ ‡é¢˜åç¼€ï¼ˆå‹å·ç¼–å·ï¼‰
- äº§å“é¢œè‰²/è§„æ ¼
- è¿›è´§ä»·/æˆæœ¬ä»·

#### JSONæ ¼å¼

```json
{
  "staff_name": "å¼ ä¸‰",
  "products": [
    {
      "product_name": "è¯ç®±æ”¶çº³ç›’",
      "model_number": "A0049",
      "cost_price": 15.0,
      "color_spec": "ç™½è‰²/å¤§å·",
      "collect_count": 5
    }
  ]
}
```

---

## ä½¿ç”¨æ–¹å¼

### æ–¹å¼1: å‘½ä»¤è¡Œæ‰‹åŠ¨æ‰§è¡Œ

#### åŸºç¡€ç”¨æ³•

```bash
# ä½¿ç”¨Excelè¾“å…¥
python scripts/run_production.py data/input/selection.xlsx

# ä½¿ç”¨JSONè¾“å…¥
python scripts/run_production.py config/products.json --type json

# æŒ‡å®šäººå‘˜ç­›é€‰
python scripts/run_production.py selection.xlsx --staff-name "å¼ ä¸‰"
```

#### é«˜çº§é€‰é¡¹

```bash
# Dry-runæ¨¡å¼ï¼ˆä¸å®é™…æ‰§è¡Œï¼Œä»…æµ‹è¯•ï¼‰
python scripts/run_production.py selection.xlsx --dry-run

# ä»…æ‰§è¡Œæ‰¹é‡ç¼–è¾‘ï¼Œä¸å‘å¸ƒ
python scripts/run_production.py selection.xlsx --no-publish

# ä¸ä½¿ç”¨AIç”Ÿæˆæ ‡é¢˜
python scripts/run_production.py selection.xlsx --no-ai-titles

# è·³è¿‡å¥åº·æ£€æŸ¥
python scripts/run_production.py selection.xlsx --skip-health-check

# æŒ‡å®šé…ç½®æ–‡ä»¶
python scripts/run_production.py selection.xlsx --config config/custom.yaml
```

#### é€šè¿‡CLIå‘½ä»¤æ‰§è¡Œ

```bash
# ä½¿ç”¨temu-auto-publishå‘½ä»¤ï¼ˆéœ€è¦å®‰è£…ï¼‰
temu-auto-publish workflow run -p selection.xlsx

# æŸ¥çœ‹å·¥ä½œæµçŠ¶æ€
temu-auto-publish workflow status

# æŸ¥çœ‹å·¥ä½œæµå†å²
temu-auto-publish workflow list
```

### æ–¹å¼2: å®šæ—¶ä»»åŠ¡è‡ªåŠ¨æ‰§è¡Œ

#### å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹

```bash
# å¯åŠ¨å®šæ—¶ä»»åŠ¡å®ˆæŠ¤è¿›ç¨‹
python scripts/scheduler_daemon.py start

# åå°è¿è¡Œï¼ˆå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼‰
nohup python scripts/scheduler_daemon.py start > /dev/null 2>&1 &
```

#### ç®¡ç†å®ˆæŠ¤è¿›ç¨‹

```bash
# æŸ¥çœ‹çŠ¶æ€
python scripts/scheduler_daemon.py status

# åœæ­¢å®ˆæŠ¤è¿›ç¨‹
python scripts/scheduler_daemon.py stop

# é‡å¯å®ˆæŠ¤è¿›ç¨‹
python scripts/scheduler_daemon.py restart
```

#### ä½¿ç”¨ç³»ç»ŸæœåŠ¡ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰

åˆ›å»ºsystemdæœåŠ¡ï¼š

```bash
# å¤åˆ¶æœåŠ¡æ–‡ä»¶
sudo cp scripts/deploy/systemd/temu-scheduler.service /etc/systemd/system/

# é‡æ–°åŠ è½½systemd
sudo systemctl daemon-reload

# å¯åŠ¨æœåŠ¡
sudo systemctl start temu-scheduler

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable temu-scheduler

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status temu-scheduler

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u temu-scheduler -f
```

---

## ç›‘æ§å‘Šè­¦

### æ‰§è¡Œç»“æœé€šçŸ¥

ç³»ç»Ÿä¼šè‡ªåŠ¨å‘é€æ‰§è¡Œç»“æœé€šçŸ¥åˆ°é…ç½®çš„æ¸ é“ï¼ˆé’‰é’‰/ä¼ä¸šå¾®ä¿¡/é‚®ä»¶ï¼‰ã€‚

é€šçŸ¥å†…å®¹åŒ…æ‹¬ï¼š
- å·¥ä½œæµIDå’Œæ‰§è¡Œæ—¶é—´
- å„é˜¶æ®µæ‰§è¡Œç»“æœ
- è€—æ—¶ç»Ÿè®¡
- å‘å¸ƒæˆåŠŸç‡
- é”™è¯¯è¯¦æƒ…ï¼ˆå¦‚æœ‰ï¼‰

### å¥åº·æ£€æŸ¥

#### æ‰‹åŠ¨å¥åº·æ£€æŸ¥

```bash
# å…¨é¢å¥åº·æ£€æŸ¥
temu-auto-publish health check

# æ£€æŸ¥ç‰¹å®šç»„ä»¶
temu-auto-publish health check --component browser
temu-auto-publish health check --component login
temu-auto-publish health check --component network

# JSONæ ¼å¼è¾“å‡º
temu-auto-publish health check --json
```

#### è‡ªåŠ¨å¥åº·æ£€æŸ¥

ç³»ç»Ÿä¼šåœ¨æ‰§è¡Œå‰è‡ªåŠ¨è¿›è¡Œå¥åº·æ£€æŸ¥ï¼Œæ£€æŸ¥é¡¹åŒ…æ‹¬ï¼š
- âœ… æµè§ˆå™¨çŠ¶æ€
- âœ… ç™»å½•å‡­è¯
- âœ… ç½‘ç»œè¿æ¥
- âœ… ç£ç›˜ç©ºé—´
- âœ… å†…å­˜ä½¿ç”¨
- âœ… ä¾èµ–å®Œæ•´æ€§
- âœ… é…ç½®æ–‡ä»¶

### æŒ‡æ ‡ç›‘æ§

```bash
# æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
temu-auto-publish monitor stats

# æŸ¥çœ‹æœ€è¿‘24å°æ—¶çš„ç»Ÿè®¡
temu-auto-publish monitor stats --last 24h

# æŸ¥çœ‹ç‰¹å®šå·¥ä½œæµçš„ç»Ÿè®¡
temu-auto-publish monitor stats --workflow workflow_20251103_140000

# ç”ŸæˆæŠ¥å‘Š
temu-auto-publish monitor report --output report.html
```

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f data/logs/production.log

# æŸ¥çœ‹è°ƒåº¦å™¨æ—¥å¿—
tail -f data/logs/scheduler.log

# æŸ¥çœ‹æœ€è¿‘100è¡Œ
tail -n 100 data/logs/production.log

# æœç´¢é”™è¯¯æ—¥å¿—
grep "ERROR" data/logs/production.log

# æŸ¥çœ‹ç‰¹å®šå·¥ä½œæµçš„æ—¥å¿—
grep "workflow_20251103_140000" data/logs/production.log
```

---

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. ç™»å½•å¤±è´¥

**ç—‡çŠ¶ï¼š** `ç™»å½•å¤±è´¥` æˆ– `ç™»å½•å‡­è¯é”™è¯¯`

**è§£å†³æ–¹æ³•ï¼š**
```bash
# 1. æ£€æŸ¥ç¯å¢ƒå˜é‡
cat .env | grep MIAOSHOU

# 2. æ‰‹åŠ¨æµ‹è¯•ç™»å½•
python -c "
import os
from dotenv import load_dotenv
load_dotenv()
print('Username:', os.getenv('MIAOSHOU_USERNAME'))
print('Password:', '***' if os.getenv('MIAOSHOU_PASSWORD') else 'Not set')
"

# 3. éªŒè¯å‡­è¯æœ‰æ•ˆæ€§
temu-auto-publish health check --component login
```

#### 2. æµè§ˆå™¨å¯åŠ¨å¤±è´¥

**ç—‡çŠ¶ï¼š** `Playwright Chromiumæœªå®‰è£…` æˆ– `æµè§ˆå™¨å¯åŠ¨è¶…æ—¶`

**è§£å†³æ–¹æ³•ï¼š**
```bash
# 1. é‡æ–°å®‰è£…æµè§ˆå™¨
playwright install chromium

# 2. æ£€æŸ¥æµè§ˆå™¨çŠ¶æ€
temu-auto-publish health check --component browser

# 3. æŸ¥çœ‹æµè§ˆå™¨é…ç½®
cat config/browser_config.json
```

#### 3. ç½‘ç»œè¿æ¥é—®é¢˜

**ç—‡çŠ¶ï¼š** `ç½‘ç»œè¯·æ±‚è¶…æ—¶` æˆ– `æ— æ³•è®¿é—®å¦™æ‰‹ERP`

**è§£å†³æ–¹æ³•ï¼š**
```bash
# 1. æ£€æŸ¥ç½‘ç»œè¿æ¥
temu-auto-publish health check --component network

# 2. æ‰‹åŠ¨æµ‹è¯•è¿æ¥
curl -I https://seller.kuajingmaihuo.com

# 3. æ£€æŸ¥ä»£ç†è®¾ç½®
env | grep -i proxy
```

#### 4. ç£ç›˜ç©ºé—´ä¸è¶³

**ç—‡çŠ¶ï¼š** `ç£ç›˜ç©ºé—´ä¸è¶³` æˆ– `æ— æ³•å†™å…¥æ–‡ä»¶`

**è§£å†³æ–¹æ³•ï¼š**
```bash
# 1. æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# 2. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
rm -rf data/temp/*
rm -rf data/debug/*

# 3. æ¸…ç†æ—§æ—¥å¿—
find data/logs -name "*.log" -mtime +30 -delete

# 4. å‹ç¼©æ—§æŒ‡æ ‡
find data/metrics -name "*.json" -mtime +90 -exec gzip {} \;
```

#### 5. å®šæ—¶ä»»åŠ¡æœªæ‰§è¡Œ

**ç—‡çŠ¶ï¼š** åˆ°äº†é¢„å®šæ—¶é—´ä½†ä»»åŠ¡æ²¡æœ‰è¿è¡Œ

**è§£å†³æ–¹æ³•ï¼š**
```bash
# 1. æ£€æŸ¥å®ˆæŠ¤è¿›ç¨‹çŠ¶æ€
python scripts/scheduler_daemon.py status

# 2. æ£€æŸ¥ä»»åŠ¡é…ç½®
grep -A 10 "jobs:" config/production.yaml

# 3. æŸ¥çœ‹è°ƒåº¦å™¨æ—¥å¿—
tail -f data/logs/scheduler.log

# 4. æ£€æŸ¥ä»»åŠ¡é”
ls -la data/job.lock  # å¦‚æœå­˜åœ¨ä¸”é•¿æ—¶é—´æœªé‡Šæ”¾ï¼Œæ‰‹åŠ¨åˆ é™¤

# 5. é‡å¯å®ˆæŠ¤è¿›ç¨‹
python scripts/scheduler_daemon.py restart
```

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼ˆåœ¨production.yamlä¸­ï¼‰
debug:
  enabled: true
  auto_screenshot: true
  auto_save_html: true

# è¿è¡Œæ—¶å¯ç”¨è¯¦ç»†æ—¥å¿—
export LOG_LEVEL=DEBUG
python scripts/run_production.py selection.xlsx
```

### è·å–å¸®åŠ©

å¦‚æœé‡åˆ°æ— æ³•è§£å†³çš„é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ—¥å¿—ï¼š** `data/logs/production.log`
2. **è¿è¡ŒéªŒè¯ï¼š** `python scripts/validate_production.py validate`
3. **æŸ¥çœ‹å¥åº·çŠ¶æ€ï¼š** `temu-auto-publish health check`
4. **è”ç³»æŠ€æœ¯æ”¯æŒï¼š** é™„å¸¦å®Œæ•´çš„é”™è¯¯æ—¥å¿—å’Œæ‰§è¡ŒæŠ¥å‘Š

---

## æœ€ä½³å®è·µ

### 1. å®šæœŸç»´æŠ¤

```bash
# æ¯å‘¨æ‰§è¡Œä¸€æ¬¡
# 1. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
rm -rf data/temp/*

# 2. å‹ç¼©æ—§æ—¥å¿—ï¼ˆä¿ç•™æœ€è¿‘30å¤©ï¼‰
find data/logs -name "*.log" -mtime +30 -exec gzip {} \;

# 3. å¤‡ä»½é‡è¦æ•°æ®
tar -czf backup_$(date +%Y%m%d).tar.gz data/output data/workflow_states

# 4. æ£€æŸ¥ç³»ç»Ÿå¥åº·
temu-auto-publish health check

# 5. æ›´æ–°ä¾èµ–
uv sync
```

### 2. ç›‘æ§å»ºè®®

- **è®¾ç½®å‘Šè­¦é˜ˆå€¼ï¼š** åœ¨é…ç½®ä¸­è®¾ç½®åˆç†çš„è­¦å‘Šå’Œé”™è¯¯é˜ˆå€¼
- **å®šæœŸæŸ¥çœ‹æŠ¥å‘Šï¼š** æ¯å‘¨æŸ¥çœ‹ä¸€æ¬¡æ‰§è¡Œç»Ÿè®¡æŠ¥å‘Š
- **å…³æ³¨æˆåŠŸç‡ï¼š** å‘å¸ƒæˆåŠŸç‡åº”ä¿æŒåœ¨90%ä»¥ä¸Š
- **ç›‘æ§èµ„æºä½¿ç”¨ï¼š** å®šæœŸæ£€æŸ¥ç£ç›˜å’Œå†…å­˜ä½¿ç”¨æƒ…å†µ

### 3. å®‰å…¨å»ºè®®

- **å‡­è¯ç®¡ç†ï¼š** ä¸è¦å°†.envæ–‡ä»¶æäº¤åˆ°git
- **å®šæœŸæ›´æ–°å¯†ç ï¼š** æ¯æœˆæ›´æ–°ä¸€æ¬¡ç™»å½•å¯†ç 
- **æ—¥å¿—è„±æ•ï¼š** ç¡®ä¿æ—¥å¿—ä¸­ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯
- **æƒé™æ§åˆ¶ï¼š** é™åˆ¶ç”Ÿäº§è„šæœ¬çš„æ‰§è¡Œæƒé™

### 4. æ€§èƒ½ä¼˜åŒ–

- **æ‰¹é‡å¤„ç†ï¼š** æ¯æ¬¡å¤„ç†5ä¸ªäº§å“æ•ˆç‡æœ€é«˜
- **å®šæ—¶è°ƒåº¦ï¼š** é¿å¼€é«˜å³°æœŸï¼ˆå»ºè®®9:00-11:00æˆ–14:00-16:00ï¼‰
- **èµ„æºé™åˆ¶ï¼š** å•ä¸ªå·¥ä½œæµä¸è¶…è¿‡1å°æ—¶
- **å¹¶å‘æ§åˆ¶ï¼š** åŒä¸€æ—¶é—´åªè¿è¡Œä¸€ä¸ªå·¥ä½œæµ

### 5. æ•°æ®å¤‡ä»½

```bash
# è‡ªåŠ¨å¤‡ä»½è„šæœ¬ï¼ˆæ·»åŠ åˆ°crontabï¼‰
#!/bin/bash
BACKUP_DIR=/backup/temu-auto-publish
DATE=$(date +%Y%m%d)

# å¤‡ä»½è¾“å‡ºæ•°æ®
tar -czf $BACKUP_DIR/output_$DATE.tar.gz data/output

# å¤‡ä»½å·¥ä½œæµçŠ¶æ€
tar -czf $BACKUP_DIR/states_$DATE.tar.gz data/workflow_states

# ä¿ç•™æœ€è¿‘30å¤©çš„å¤‡ä»½
find $BACKUP_DIR -name "*.tar.gz" -mtime +30 -delete
```

### 6. ç‰ˆæœ¬ç®¡ç†

```bash
# è®°å½•æ¯æ¬¡æ›´æ–°
git log --oneline --graph

# æ ‡è®°ç¨³å®šç‰ˆæœ¬
git tag -a v1.0.0 -m "ç”Ÿäº§ç‰ˆæœ¬1.0.0"

# å›æ»šåˆ°ç¨³å®šç‰ˆæœ¬
git checkout v1.0.0
```

---

## é™„å½•

### A. å®Œæ•´å‘½ä»¤å‚è€ƒ

#### ç”Ÿäº§è„šæœ¬å‘½ä»¤

```bash
python scripts/run_production.py <input_file> [OPTIONS]

Options:
  --type, -t TEXT              è¾“å…¥ç±»å‹(excel/json)
  --config, -c PATH            é…ç½®æ–‡ä»¶è·¯å¾„
  --staff-name, -s TEXT        äººå‘˜åç§°
  --batch-edit/--no-batch-edit æ˜¯å¦æ‰¹é‡ç¼–è¾‘
  --publish/--no-publish       æ˜¯å¦å‘å¸ƒ
  --ai-titles/--no-ai-titles   æ˜¯å¦ä½¿ç”¨AIæ ‡é¢˜
  --dry-run                    Dry-runæ¨¡å¼
  --skip-health-check          è·³è¿‡å¥åº·æ£€æŸ¥
```

#### å®ˆæŠ¤è¿›ç¨‹å‘½ä»¤

```bash
python scripts/scheduler_daemon.py {start|stop|status|restart} [OPTIONS]

Subcommands:
  start    å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹
  stop     åœæ­¢å®ˆæŠ¤è¿›ç¨‹
  status   æŸ¥çœ‹çŠ¶æ€
  restart  é‡å¯å®ˆæŠ¤è¿›ç¨‹

Options:
  --config PATH  é…ç½®æ–‡ä»¶è·¯å¾„
  --daemon       åå°è¿è¡Œæ¨¡å¼
```

#### CLIå‘½ä»¤

```bash
temu-auto-publish [COMMAND] [OPTIONS]

Commands:
  workflow  å·¥ä½œæµç®¡ç†
  monitor   ç›‘æ§å’ŒæŒ‡æ ‡
  debug     è°ƒè¯•åŠŸèƒ½
  config    é…ç½®ç®¡ç†
  health    å¥åº·æ£€æŸ¥
  version   ç‰ˆæœ¬ä¿¡æ¯
  status    ç³»ç»ŸçŠ¶æ€
  setup     åˆå§‹åŒ–å‘å¯¼
```

### B. é…ç½®æ–‡ä»¶æ¨¡æ¿

å®Œæ•´çš„é…ç½®æ–‡ä»¶æ¨¡æ¿è¯·å‚è€ƒï¼š
- `config/production.yaml` - ç”Ÿäº§ç¯å¢ƒé…ç½®
- `config/notification.yaml.template` - é€šçŸ¥é…ç½®æ¨¡æ¿
- `.env.example` - ç¯å¢ƒå˜é‡ç¤ºä¾‹

### C. ç›¸å…³æ–‡æ¡£

- [SOPæ“ä½œæ–‡æ¡£](docs/projects/temu-auto-publish/guides/å•†å“å‘å¸ƒSOP-ITä¸“ç”¨.md)
- [å¼€å‘æ–‡æ¡£](README.md)
- [APIæ–‡æ¡£](docs/api/)

---

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-11-03)

- âœ¨ é¦–ä¸ªç”Ÿäº§ç‰ˆæœ¬å‘å¸ƒ
- âœ… å®Œæ•´å®ç°SOPæ­¥éª¤4-11
- ğŸ”” æ”¯æŒå¤šæ¸ é“é€šçŸ¥
- â° æ”¯æŒå®šæ—¶ä»»åŠ¡è°ƒåº¦
- ğŸ¥ å®Œæ•´çš„å¥åº·æ£€æŸ¥
- ğŸ“Š æŒ‡æ ‡æ”¶é›†å’ŒæŠ¥å‘Š

---

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»ï¼š

- **æŠ€æœ¯è´Ÿè´£äººï¼š** [æ‚¨çš„åå­—]
- **é‚®ç®±ï¼š** [æ‚¨çš„é‚®ç®±]
- **æ–‡æ¡£åœ°å€ï¼š** [æ–‡æ¡£é“¾æ¥]

---

**âš ï¸ é‡è¦æç¤ºï¼š**

1. é¦–æ¬¡ä½¿ç”¨è¯·åŠ¡å¿…å…ˆæ‰§è¡ŒéªŒè¯ï¼š`python scripts/validate_production.py validate`
2. å»ºè®®å…ˆä½¿ç”¨`--dry-run`æ¨¡å¼æµ‹è¯•
3. å®šæœŸå¤‡ä»½é‡è¦æ•°æ®
4. ä¿æŒç³»ç»Ÿå’Œä¾èµ–æ›´æ–°

**ç¥ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰**

